export default class ArticlesController {

    constructor($scope, $http) {
        this.scope = $scope;
        this.http = $http;
    }

    addPagination() {
        this.scope.currentPage = 1;
        this.scope.totalPages = 0;
    }

    getArticles() {
        let $scope = this.scope;
        this.http.get('http://192.168.190.137:3000/article').success(function(data) {
            $scope.articles = data.data;
        });
    }

    addCommentListener() {
        let $scope = this.scope;
        let $http = this.http;
        $scope.commentaires = [];
	$scope.classe = [];
	$scope.CheckRemplissage = function(id){
	    if($scope.commentaires[id]){
		$scope.classe[id] = 'has-success';
	    }else{
		$scope.classe[id] = 'has-error';
	    }
	}
	$scope.addComment = function(id) {
	    if($scope.commentaires[id]){
		var comment = {
                    contenu : $scope.commentaires[id],
                    //TODO : matching avec le user connect√©
                    auteur : "test"
		};
		$http.post('http://192.168.190.137:3000/article/'+ id, comment).success(function(data) {
                    $http.get('http://192.168.190.137:3000/article').success(function(data) {
			$scope.articles = data.data;
			$scope.commentaires[id] = "";
                    });
		});
	    }
	    else
		$scope.classe[id] = 'has-error';
        }
    }
}
